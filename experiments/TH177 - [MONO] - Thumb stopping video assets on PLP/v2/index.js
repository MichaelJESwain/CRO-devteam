const TH177 = {
    utils: window["optimizely"].get("utils"),
    state: {},
    productSKUs: [
        {sku: 'WW0WW35668_09Y', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/1_WW0WW35668_09Y_video_pdp_790x1056.mp4?v=1666684139', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35668_09Y_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW36180_YBI', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/10_WW0WW36180_YBI_video_pdp_790x1056.mp4?v=1666684142', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW36180_YBI_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW36701_C6X', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/11_WW0WW36701_C6X_video_pdp_790x1056.mp4?v=1666684142', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW36701_C6X_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW37396_09Y', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/12_WW0WW37396_09Y_video_pdp_790x1056.mp4?v=1666684142', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW37396_09Y_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW35922_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/13_WW0WW35922_DW5_video_pdp_790x1056.mp4?v=1666684142', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35922_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW37398_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/14_WW0WW37398_DW5_video_pdp_790x1056.mp4?v=1666684143', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW37398_DW5_main_listing?$plp_max_225@2x$'},    
        {sku: 'WW0WW37479_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/15_WW0WW37479_DW5_video_pdp_790x1056.mp4?v=1666684143', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW37479_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW36159_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/16_WW0WW36159_DW5_video_pdp_790x1056.mp4?v=1666684143', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW36159_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW36162_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/17_WW0WW36162_DW5_video_pdp_790x1056.mp4?v=1666684143', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW36162_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'UW0UW03959_0JG', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/18_UW0UW03959_0JG_video_pdp_790x1056.mp4?v=1666684144', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/UW0UW03959_0JG_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW35747_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/19_WW0WW35747_DW5_video_pdp_790x1056.mp4?v=1666684144', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35747_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW35909_0A4', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/20_WW0WW35909_0A4_video_pdp_790x1056.mp4?v=1666684144', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35909_0A4_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW35913_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/21_WW0WW35913_DW5_video_pdp_790x1056.mp4?v=1666684144', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35913_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW36716_0GE', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/22_WW0WW36716_0GE_video_pdp_790x1056.mp4?v=1666684145', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW36716_0GE_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW37312_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/23_WW0WW37312_DW5_video_pdp_790x1056.mp4?v=1666684145', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW37312_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW37439_YBL', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/24_WW0WW37439_YBL_video_pdp_790x1056.mp4?v=1666684145', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW37439_YBL_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW37465_YBI', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/25_WW0WW37465_YBI_video_pdp_790x1056.mp4?v=1666684145', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW37465_YBI_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW37479_YBL', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/26_WW0WW37479_YBL_video_pdp_790x1056.mp4?v=1666684145', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW37479_YBL_main_listing?$plp_max_225@2x$'},
        {sku: 'FW0FW07058_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/27_FW0FW07058_DW5_video_pdp_790x1056.mp4?v=1666684145', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/FW0FW07058_DW5_main_listing?$plp_max_225@2x$'},   
        {sku: 'AW0AW13387_YBI', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/28_AW0AW13387_YBI_video_pdp_790x1056.mp4?v=1666684146', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/AW0AW13387_YBI_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW29057_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/29_MW0MW29057_DW5_video_pdp_790x1056.mp4?v=1666684146', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW29057_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'UM0UM02721_0KG', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/2_UM0UM02721_0KG_video_pdp_790x1056.mp4?v=1666684139', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/UM0UM02721_0KG_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW29399_1CU', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/30_MW0MW29399_1CU_video_pdp_790x1056.mp4?v=1666684146', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW29399_1CU_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28208_VLP', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/31_MW0MW28208_VLP_video_pdp_790x1056.mp4?v=1666684146', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28208_VLP_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW27427_GW8', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/32_MW0MW27427_GW8_video_pdp_790x1056.mp4?v=1666684147', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW27427_GW8_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28747_C7L', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/33_MW0MW28747_C7L_video_pdp_790x1056.mp4?v=1666684147', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28747_C7L_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28089_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/34_MW0MW28089_DW5_video_pdp_790x1056.mp4?v=1666684147', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28089_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28096_0GY', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/35_MW0MW28096_0GY_video_pdp_790x1056.mp4?v=1666684147', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28096_0GY_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW27374_C7L', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/36_MW0MW27374_C7L_video_pdp_790x1056.mp4?v=1666684147', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW27374_C7L_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW27693_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/37_MW0MW27693_DW5_video_pdp_790x1056.mp4?v=1666684147', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW27693_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28720_0A4', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/38_MW0MW28720_0A4_video_pdp_790x1056.mp4?v=1666684148', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28720_0A4_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28732_GWJ', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/39_MW0MW28732_GWJ_video_pdp_790x1056.mp4?v=1666684148', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28732_GWJ_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW35931_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/3_WW0WW35931_DW5_video_pdp_790x1056.mp4?v=1666684140', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35931_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28187_VLP', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/40_MW0MW28187_VLP_video_pdp_790x1056.mp4?v=1666684148', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28187_VLP_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW29253_0HD', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/41_MW0MW29253_0HD_video_pdp_790x1056.mp4?v=1666684148', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW29253_0HD_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW29254_0GY', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/42_MW0MW29254_0GY_video_pdp_790x1056.mp4?v=1666684148', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW29254_0GY_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW29252_0A4', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/43_MW0MW29252_0A4_video_pdp_790x1056.mp4?v=1666684138', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW29252_0A4_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28044_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/44_MW0MW28044_DW5_video_pdp_790x1056.mp4?v=1666684138', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28044_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28045_YBI', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/45_MW0MW28045_YBI_video_pdp_790x1056.mp4?v=1666684138', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28045_YBI_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28052_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/46_MW0MW28052_DW5_video_pdp_790x1056.mp4?v=1666684138', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28052_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'MW0MW28229_YBI', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/47_MW0MW28229_YBI_video_pdp_790x1056.mp4?v=1666684139', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/MW0MW28229_YBI_main_listing?$plp_max_225@2x$'},
        {sku: 'FM0FM04369_DW5', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/48_FM0FM04369_DW5_video_pdp_790x1056.mp4?v=1666684139', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/FM0FM04369_DW5_main_listing?$plp_max_225@2x$'},
        {sku: 'THF5504425_350', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/49_THF5504425_350_video_pdp_790x1056.mp4?v=1666684139', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/THF5504425_350_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW35625_0KR', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/4_WW0WW35625_0KR_video_pdp_790x1056.mp4?v=1666684140', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35625_0KR_hover?$plp_max_225@2x$'},
        {sku: 'THF5600425_350', video: 'hhttps://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/50_THF5600425_350_video_pdp_790x1056.mp4?v=1666684139', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/THF5600425_350_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW31990_09Y', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/5_WW0WW31990_09Y_video_pdp_790x1056.mp4?v=1666684141', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW31990_09Y_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW36622_GW8', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/6_WW0WW36622_GW8_video_pdp_790x1056.mp4?v=1666684141', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW36622_GW8_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW35932_GW8', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/7_WW0WW35932_GW8_video_pdp_790x1056.mp4?v=1666684141', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35932_GW8_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW35692_09Y', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/8_WW0WW35692_09Y_video_pdp_790x1056.mp4?v=1666684141', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW35692_09Y_main_listing?$plp_max_225@2x$'},
        {sku: 'WW0WW37751_VLP', video: 'https://data.theasset.store/data/PVH%20TH/VTH02SZ22%20-%20TH%20Videos%202022/materials/TH%20Product%20Videos%202022/review_20221025074909/9_WW0WW37751_VLP_video_pdp_790x1056.mp4?v=1666684142', poster: 'https://tommy-europe.scene7.com/is/image/TommyEurope/WW0WW37751_VLP_main_listing?$plp_max_225@2x$'}
    ],
    init: function() {
        let products = TH177.getTargetProduct();

        for (let i = 0; i < products.length; i++) {
            products[i] = TH177.buildVideoMarkup(products[i]);
            TH177.insertVideo(products[i], i);
        }

        TH177.isProductInViewport();
        TH177.triggerAutoplayOnTouchStart();
        
        if (!TH177.state.isWaitingForProductList) {
            TH177.waitForProductListElement();
        }
        if (!TH177.state.waitForProductListChanges) {
            TH177.waitForProductListChanges();
        }
    },
    getTargetProduct: function() {
        let productList = [];

        for (let i = 0; i < document.querySelectorAll('[data-testid="product-list-items"]').length; i++) {
            let counter = TH177.productSKUs.length;
            let product = false;
            for (let j = 0; j < counter; j++) {
                if ( document.querySelectorAll('[data-testid="product-list-items"]')[i].querySelector(`[data-uid=${TH177.productSKUs[j].sku}]`)) {
                        product = {
                            key: j
                        };
                        productList.push(product);
                        counter = 0;
                }      
            }
        }
        return productList;
    },
    buildVideoMarkup: function(product) {
        const productVideo = document.createElement('div');
        productVideo.setAttribute('class', 'TH177_product_video_container');

        productVideo.innerHTML = `
            <video class="TH177_product_video" poster="${TH177.productSKUs[product.key].poster}" autoplay="" muted="" autoplay muted playsinline loop width="100%" height="100%">
                <source src="${TH177.productSKUs[product.key].video}" type="video/mp4">
                Your browser does not support the video tag.
            <video>
        `;

        productVideo.querySelector('.TH177_product_video').playVid = function() {
            productVideo.querySelector('.TH177_product_video').oncanplaythrough = function() {
                productVideo.querySelector('.TH177_product_video').muted = true;
                productVideo.querySelector('.TH177_product_video').play();
            };

            productVideo.querySelector('.TH177_product_video').oncanplaythrough();
        };

        product.video = productVideo;

        return product;
    },
    insertVideo: function(product, containerIndex) {
        const {key, video} = product;

        if (document.querySelectorAll('[data-testid="product-list-items"]')[containerIndex].querySelectorAll('#TH177_hero_product').length)  {
            document.querySelectorAll('[data-testid="product-list-items"]')[containerIndex].querySelector('.TH177_product_video_container').parentElement.removeChild(document.querySelectorAll('[data-testid="product-list-items"]')[containerIndex].querySelector('.TH177_product_video_container'));
            document.querySelectorAll('[data-testid="product-list-items"]')[containerIndex].querySelector('#TH177_hero_product').removeAttribute('id');
        }



        if (!document.querySelector(`[data-uid=${TH177.productSKUs[key].sku}] .TH177_product_video_container`)) {
            document.querySelector(`[data-uid=${TH177.productSKUs[key].sku}] [data-testid="list-primary"] .product-image__plp`).insertBefore(video,  document.querySelector(`[data-uid=${TH177.productSKUs[key].sku}] [data-testid="list-primary"] .product-image__plp`).firstElementChild);
            
            if (parseInt(document.querySelector(`[data-uid=${TH177.productSKUs[key].sku}]`).getAttribute('data-index')) < 4) {
                document.querySelectorAll('[data-testid="product-list-items"]')[containerIndex].querySelectorAll('[data-testid="product-list-item"]')[5].parentElement.insertBefore(document.querySelector(`[data-uid=${TH177.productSKUs[key].sku}]`), document.querySelectorAll('[data-testid="product-list-items"]')[containerIndex].querySelectorAll('[data-testid="product-list-item"]')[5]);
            } else {
                document.querySelectorAll('[data-testid="product-list-items"]')[containerIndex].querySelectorAll('[data-testid="product-list-item"]')[4].parentElement.insertBefore(document.querySelector(`[data-uid=${TH177.productSKUs[key].sku}]`), document.querySelectorAll('[data-testid="product-list-items"]')[containerIndex].querySelectorAll('[data-testid="product-list-item"]')[4]);
            }

            document.querySelector(`[data-uid=${TH177.productSKUs[key].sku}]`).setAttribute('id', 'TH177_hero_product');
        }
    },
    isProductInViewport: function() {
        let observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0
        };
        
        var observer = new IntersectionObserver(observerCallback, observerOptions);
        
        function observerCallback(entries, observer) {
            entries.forEach(entry => {
                if(entry.isIntersecting) {
                    entry.target.play();
                } else {
                    entry.target.pause();
                }
            });
        };
        
        const target = document.querySelectorAll('.TH177_product_video');
        target.forEach(function(elem) {
            observer.observe(elem);
        });
           

    },
    triggerAutoplayOnTouchStart: function() {
        window.addEventListener('touchstart', function() {
            document.querySelectorAll('.TH177_product_video').forEach(function(video) {
                video.playVid();
            });
    }, {once : true});   
    },
    waitForProductListChanges: function() {
        TH177.state.waitForProductListChanges = true;
        const targetNode = document.querySelector('[data-testid="product-list-items"]');
        const config = { childList: true};
        let callbackFired = false;

        const callback = (mutationList, observer) => {
            if (!callbackFired) {
                let res = false;
                for (const mutation of mutationList) {
                    if (mutation.type === 'childList') {
                        res = true;
                    }
                }
                if (res) {
                    TH177.init();
                }
                callbackFired = true;
                setTimeout(function() {
                    callbackFired = false;
                }, 300);
            }
        };
    
        const observer = new MutationObserver(callback);
    
        observer.observe(targetNode, config);
    },
    waitForProductListElement: function() {
        TH177.state.isWaitingForProductList = true;
        TH177.utils.observeSelector('[data-testid="product-list-items"]', function() {
            TH177.state.waitForProductListChanges = false;
            TH177.init();
        });
    }
};

if (!window.location.pathname.includes('/shopping-bag')) {
    TH177.init();
}
